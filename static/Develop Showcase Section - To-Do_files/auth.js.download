/******/!function(n){// webpackBootstrap
/******/var r={};function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=n,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o(o.s=767)}({102:function(t,e,n){"use strict";e.a=function(t){return t?window.__initialState&&window.__initialState[t]:window.__initialState}},103:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return a});var r=n(21),o=Object(r.b)({plannerToken:null}),a=Object(r.b)({plannerRedirectURL:null})},105:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return i});var a=function(t){for(var e={},n=0,r=t.length;n<r;n++)e[t.charAt(n)]=n;return e}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),r=function(t){var e=t.length,n=e%4,r=(0<e?a[t.charAt(0)]<<18:0)|(1<e?a[t.charAt(1)]<<12:0)|(2<e?a[t.charAt(2)]<<6:0)|(3<e?a[t.charAt(3)]:0),o=[String.fromCharCode(r>>>16),String.fromCharCode(r>>>8&255),String.fromCharCode(255&r)];return o.length-=[0,0,2,1][n],o.join("")};function o(t){try{if(!i(t))throw new TypeError("Provided token is not a valid JWT.");var e=t.split(".")[1].replace(/[\s\S]{1,4}/g,r);return{upn:e.match(/.*"upn"\s*:\s*"([^"]+)"/)[1],tid:e.match(/.*"tid"\s*:\s*"([^"]+)"/)[1],puid:e.match(/.*"puid"\s*:\s*"([^"]+)"/)[1]}}catch(t){return}}function i(t){try{return"jwt"===JSON.parse(atob(t.split(".")[0])).typ.toLowerCase()}catch(t){return!1}}},110:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(21),o=Object(r.b)({redirectPath:null})},113:function(t,e,n){"use strict";var r=n(21),o=n(128),a=n(53),i=n(176),u=n(119),c=n(198),s=n(199),f=n(200),d=n(103),l=n(160),h=n(132);n.d(e,"a",function(){return p});var p=Object(r.a)(a.a,o.a,o.b,a.g,d.b,d.a,u.b,u.a,i.a,i.b,a.d,a.b,s.a,i.c,f.a,c.a,h.ServerResponseState,h.RedirectHistoryState,h.RoutingState,h.FeatureFlagsState,l.a)},119:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return a});var r=n(21),o=Object(r.b)({exoToken:null}),a=Object(r.b)({exoRedirectURL:null})},128:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return u});var r=n(21),o=n(110),a=Object(r.b)({authHint:null}),i=Object(r.b)({authSwitch:!1}),u=Object(r.a)(i,o.a)},129:function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return u});var r=[/^microsoft\.com$/,/^[^@/]*\.microsoft.com$/],o=[/^testliotodo\.onmicrosoft\.com$/,/^tlio1\.onmicrosoft\.com$/,/^m365x218284\.onmicrosoft\.com$/];function a(t,e){var n=t.toLowerCase().trim().split("@")[1];return e.some(function(t){return t.test(n)})}var i=function(t){return void 0===t&&(t=""),a(t,r)},u=function(t){return void 0===t&&(t=""),i(t)||(void 0===(e=t)&&(e=""),a(e,o));var e}},132:function(t,e,n){"use strict";var r=n(190);n.o(r,"FeatureFlagsState")&&n.d(e,"FeatureFlagsState",function(){return r.FeatureFlagsState}),n.o(r,"RedirectHistoryState")&&n.d(e,"RedirectHistoryState",function(){return r.RedirectHistoryState}),n.o(r,"RoutingState")&&n.d(e,"RoutingState",function(){return r.RoutingState}),n.o(r,"ServerResponseState")&&n.d(e,"ServerResponseState",function(){return r.ServerResponseState});var o=n(161);n.d(e,"FeatureFlagsState",function(){return o.a});var a=n(110);n.d(e,"RedirectHistoryState",function(){return a.a});var i=n(162);n.d(e,"RoutingState",function(){return i.a});var u=n(163);n.d(e,"ServerResponseState",function(){return u.a})},141:function(t,e,n){"use strict";var r={development:"dev",staging:"dev",nightly:"nightly",weekly:"weekly",beta:"beta",production:"release"},o=function(t){return r[t]},a=function(){return window&&window.location?window.location.host:"undefined"},i=n(177),u=n(102),c=-1<["production","beta","weekly","nightly"].indexOf("production"),s={"AppInfo.Name":"ToDo",product_version:"1.50.1",product_build:o((Object(u.a)("app")||{releaseStage:"test"}).releaseStage),host:a(),is_testing:""+!c};e.a=function(){return Object(i.createTracker)(s)}},160:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(21),o=Object(r.b)({isOnline:!0})},161:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(21),o=Object(r.b)({featureFlags:null})},162:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(21),o=Object(r.b)({mainAppFilePath:null}),a=Object(r.b)({invitationAppFilePath:null}),i=Object(r.a)(o,a)},163:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(21),o=Object(r.b)({latestServerError:{code:null,description:null}})},176:function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i});var r=n(21),o=Object(r.b)({user:null}),a=Object(r.b)({aadUserDataURL:null}),i=Object(r.b)({msaUserDataURL:null})},177:function(t,e,n){t.exports=n(234)(41)},178:function(t,e,n){t.exports=function(t){return"https://todo-web-endpoint.azureedge.net"+("/"===t[0]?"":"/")+t}},190:function(t,e){},198:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(21),o=Object(r.b)({isAADAvailable:null})},199:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(21),o=Object(r.b)({tenantCheckURL:null})},200:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(21),o=Object(r.b)({licenses:null})},201:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return o});var r="to_do_auth_popup",o=function(){return self!==top||opener&&name===r}},21:function(t,e,n){"use strict";function r(n){return function(t){var e=Object.assign({},n);return t?
// export const ClientLicensesState = <T extends ClientLicensesState>({ licenses }: T) => ({ licenses }) as ClientLicensesState
function(r,t){var e=[];for(var n in t)t.hasOwnProperty(n)&&r.hasOwnProperty(n)&&e.push(n);return 0<e.length?e.reduce(function(t,e){var n;return Object.assign(t,((n={})[e]=r[e],n))},{}):t}(t,e):e}}function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(-1!==e.indexOf(void 0))throw new Error("Unit composition is borked! Check how you import all the units");return function(n){var t=e[0];return 1===e.length?t(n):e.reduce(function(t,e){return Object.assign(t,e(n))},{})}}n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o})},234:function(t,e){t.exports=telemetry},241:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(113);function o(t,e){try{return Object(r.a)(JSON.parse(e.getItem("todo-auth-context")))}catch(t){return console.log("AuthState is not available in Storage 'todo-auth-context'"),Object(r.a)()}}},284:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(285);function o(t){if(t.user&&!t.user.jitMailboxCreated)return[Object(r.a)()]}},285:function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i});var r=n(58);function o(){return{type:"fetch/mailbox"}}var a=Object(r.a)("jitMailbox/sendJITRequest"),i=function(t,e,n){return t.fetch("https://outlook.office.com/api/beta/me/taskfolders",(r=e.exoToken,{headers:new Headers({Authorization:"Bearer "+r})})).then(u(e)).then(c(e));var r},u=function(t){return function(t){return t.ok?(a.authZ.info("AuthFlowStepCompleted","JIT Mailbox creation succeeded"),{value:!0}):(a.authZ.warn("AuthFlowStepFailed","JIT Mailbox creation failed"),{value:!1})}},c=function(e){return function(t){return e.user.jitMailboxCreated=t.value,e}}},286:function(t,e,n){"use strict";function r(t){if("msa"===t.flowType&&!t.exoToken)return[(e=t,{type:"redirect",path:e.exoRedirectURL})];var e}n.d(e,"a",function(){return r})},287:function(t,e,n){"use strict";var r=n(190);n.o(r,"OverrideCommand")&&n.d(e,"OverrideCommand",function(){return r.OverrideCommand}),n.o(r,"ParseCommand")&&n.d(e,"ParseCommand",function(){return r.ParseCommand}),n.o(r,"clear")&&n.d(e,"clear",function(){return r.clear}),n.o(r,"error")&&n.d(e,"error",function(){return r.error}),n.o(r,"load")&&n.d(e,"load",function(){return r.load}),n.o(r,"loadClient")&&n.d(e,"loadClient",function(){return r.loadClient}),n.o(r,"notify")&&n.d(e,"notify",function(){return r.notify}),n.o(r,"notifyWhenRefreshed")&&n.d(e,"notifyWhenRefreshed",function(){return r.notifyWhenRefreshed}),n.o(r,"parse")&&n.d(e,"parse",function(){return r.parse}),n.o(r,"parseFeatureFlags")&&n.d(e,"parseFeatureFlags",function(){return r.parseFeatureFlags}),n.o(r,"parseInteractiveMode")&&n.d(e,"parseInteractiveMode",function(){return r.parseInteractiveMode}),n.o(r,"parseRedirectPath")&&n.d(e,"parseRedirectPath",function(){return r.parseRedirectPath}),n.o(r,"parseRoutingState")&&n.d(e,"parseRoutingState",function(){return r.parseRoutingState}),n.o(r,"parseServerError")&&n.d(e,"parseServerError",function(){return r.parseServerError}),n.o(r,"read")&&n.d(e,"read",function(){return r.read}),n.o(r,"readInitialState")&&n.d(e,"readInitialState",function(){return r.readInitialState}),n.o(r,"readState")&&n.d(e,"readState",function(){return r.readState}),n.o(r,"redirect")&&n.d(e,"redirect",function(){return r.redirect}),n.o(r,"restoreOriginalURL")&&n.d(e,"restoreOriginalURL",function(){return r.restoreOriginalURL}),n.o(r,"restoreURL")&&n.d(e,"restoreURL",function(){return r.restoreURL}),n.o(r,"store")&&n.d(e,"store",function(){return r.store}),n.o(r,"storeContext")&&n.d(e,"storeContext",function(){return r.storeContext}),n.o(r,"storeContextIfValid")&&n.d(e,"storeContextIfValid",function(){return r.storeContextIfValid});var o=n(340);n.d(e,"read",function(){return o.a});n(341)},289:function(t,e,n){"use strict";var r=n(161);function o(t,e){self,top;return Object(r.a)({featureFlags:e})}function a(t){return t.app.features}n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a})},308:function(t,e,n){"use strict";var r=n(342);n.o(r,"parseLocationPath")&&n.d(e,"parseLocationPath",function(){return r.parseLocationPath}),n.o(r,"parseLocationQuery")&&n.d(e,"parseLocationQuery",function(){return r.parseLocationQuery});var o=n(343);n.d(e,"parseLocationPath",function(){return o.a}),n.d(e,"parseLocationQuery",function(){return o.b})},33:function(t,e,n){"use strict";var r=n(287);n.o(r,"OverrideCommand")&&n.d(e,"OverrideCommand",function(){return r.OverrideCommand}),n.o(r,"ParseCommand")&&n.d(e,"ParseCommand",function(){return r.ParseCommand}),n.o(r,"clear")&&n.d(e,"clear",function(){return r.clear}),n.o(r,"error")&&n.d(e,"error",function(){return r.error}),n.o(r,"load")&&n.d(e,"load",function(){return r.load}),n.o(r,"loadClient")&&n.d(e,"loadClient",function(){return r.loadClient}),n.o(r,"notify")&&n.d(e,"notify",function(){return r.notify}),n.o(r,"notifyWhenRefreshed")&&n.d(e,"notifyWhenRefreshed",function(){return r.notifyWhenRefreshed}),n.o(r,"parse")&&n.d(e,"parse",function(){return r.parse}),n.o(r,"parseFeatureFlags")&&n.d(e,"parseFeatureFlags",function(){return r.parseFeatureFlags}),n.o(r,"parseInteractiveMode")&&n.d(e,"parseInteractiveMode",function(){return r.parseInteractiveMode}),n.o(r,"parseRedirectPath")&&n.d(e,"parseRedirectPath",function(){return r.parseRedirectPath}),n.o(r,"parseRoutingState")&&n.d(e,"parseRoutingState",function(){return r.parseRoutingState}),n.o(r,"parseServerError")&&n.d(e,"parseServerError",function(){return r.parseServerError}),n.o(r,"readInitialState")&&n.d(e,"readInitialState",function(){return r.readInitialState}),n.o(r,"readState")&&n.d(e,"readState",function(){return r.readState}),n.o(r,"redirect")&&n.d(e,"redirect",function(){return r.redirect}),n.o(r,"restoreOriginalURL")&&n.d(e,"restoreOriginalURL",function(){return r.restoreOriginalURL}),n.o(r,"restoreURL")&&n.d(e,"restoreURL",function(){return r.restoreURL}),n.o(r,"store")&&n.d(e,"store",function(){return r.store}),n.o(r,"storeContext")&&n.d(e,"storeContext",function(){return r.storeContext}),n.o(r,"storeContextIfValid")&&n.d(e,"storeContextIfValid",function(){return r.storeContextIfValid});var o=n(289);n.d(e,"parseFeatureFlags",function(){return o.a});var a=n(374);n.d(e,"clear",function(){return a.a}),n.d(e,"readState",function(){return a.b}),n.d(e,"store",function(){return a.c}),n.d(e,"storeContext",function(){return a.d}),n.d(e,"storeContextIfValid",function(){return a.e});var i=n(376);n.d(e,"load",function(){return i.a}),n.d(e,"loadClient",function(){return i.b}),n.d(e,"parseRoutingState",function(){return i.c});var u=n(375);n.d(e,"parseRedirectPath",function(){return u.a}),n.d(e,"restoreOriginalURL",function(){return u.b}),n.d(e,"restoreURL",function(){return u.c});var c=n(379);n.d(e,"redirect",function(){return c.a});var s=n(377);n.d(e,"notify",function(){return s.a}),n.d(e,"notifyWhenRefreshed",function(){return s.b});var f=n(380);n.d(e,"error",function(){return f.a});var d=n(381);n.d(e,"parseServerError",function(){return d.a});var l=n(382);n.d(e,"OverrideCommand",function(){return l.a}),n.d(e,"ParseCommand",function(){return l.b}),n.d(e,"parse",function(){return l.c});var h=n(383);n.d(e,"parseInteractiveMode",function(){return h.a});var p=n(378);n.d(e,"readInitialState",function(){return p.a})},34:function(t,e,n){"use strict";var c=n(36),r=function(t){return t.authSwitch?[Object(c.d)("graphToken","syncToken","exoToken","plannerToken","user"),Object(c.k)()]:[]},s=n(128),u=n(74);function o(t,e){var n,r=t.redirectPath,o=t.authHint,a=t.user,i=void 0!==e.auth;return i&&r&&(n=r,r=Object(u.c)(n,"auth_upn","auth")),o&&a&&o===a.email&&(i=!1),Object(s.c)({authSwitch:i,redirectPath:r})}var f=n(105);function a(t,e){var n=e.auth,r=e.auth_upn,o=e.username,a=t.authHint;if("aad"===t.flowType&&t.syncToken){var i=Object(f.b)(t.syncToken);i&&(a=i.upn)}n&&(a=null);var u=r||o;return u&&(a=u),Object(s.a)({authHint:a})}var i=n(53),d="2";function l(t,e){var n=t.flowType,r=e.auth,o=e.access_token;return r?n=r===d?"aad":"msa":Object(f.b)(o)&&(n="aad"),Object(i.a)({flowType:n})}function h(t,e){if(t.expirationDate<=e)return!0}function p(t){return{type:"redirect",path:t.authorizationRedirectURL}}function v(t){return t.syncToken?h(t,Date.now())?[Object(c.d)("expiresIn","expirationDate","graphToken","syncToken","exoToken","plannerToken","user"),Object(c.k)(),p(t)]:t.graphToken?void 0:[(e=t,{type:"redirect",path:e.authenticationRedirectURL})]:[p(t)];var e}function b(t){return{type:"redirect",path:t.authorizationRedirectURL}}function m(t){return t.syncToken?h(t,Date.now())?[Object(c.d)("expiresIn","expirationDate","graphToken","syncToken","exoToken","plannerToken","user"),Object(c.k)(),b(t)]:t.graphToken?void 0:[(e=t,{type:"redirect",path:e.authenticationRedirectURL})]:[b(t)];var e}function O(t,e){return Object(i.a)({flowType:e.oAuth2.defaultProvider})}function y(t,e){var n=e.expires_in;if(!n)return Object(i.f)();var r=parseInt(n,10),o=Date.now()+1e3*r;return Object(i.f)({expiresIn:r,expirationDate:o})}var g=function(t){var e;if(!t)return e;try{e=JSON.parse(atob(t))}catch(t){console.log("de-serialization failed",t)}return e};function w(t,e){var n=e.expires_in,r=e.access_token,o=e.state;if(!r||!n)return Object(i.c)();var a=g(o);if(a){if("graphToken"===a.tokenType)return Object(i.c)({graphToken:r})}else if(t.syncToken)return Object(i.c)({graphToken:r});return Object(i.c)()}function j(t,e){var n=e.expires_in,r=e.access_token,o=e.state;if(!r||!n)return Object(i.e)();var a=g(o);if(a){if("syncToken"===a.tokenType)return Object(i.e)({syncToken:r})}else if(!t.syncToken)return Object(i.e)({syncToken:r});return Object(i.e)(t)}var x="https://"+location.host+"/auth/callback",S=function(t,e,n){return e?n+"&"+t+"="+e:n},A=function(o,a){return function(t,e,n){void 0===n&&(n="");var r=(n?t.oAuth2[e][o][n]:t.oAuth2[e][o])[a];return r&&r.join(" ")}},R=A("sync","scope"),k=A("graph","scope"),C=A("sync","resource"),T=A("graph","resource"),P=A("planner","scope"),F=A("planner","resource"),L=function(n){return function(t,e){return function(t){var e;try{e=btoa(JSON.stringify(t))}catch(t){console.log("serialization failed",t)}return e}({tokenType:"exoAPI"===e&&"msa"===t&&"syncToken"===n?"exoToken":n,flowType:t})}},U=function(d,l,h){return function(t,e,n,r){void 0===n&&(n=""),void 0===r&&(r="");var o,a,i,u,c,s={authorizationURL:t.oAuth2[e].authorizationURL,clientId:(o=t,a=e,"aad"===a?o.oAuth2.aadClientId:o.oAuth2.msaClientId),scope:d(t,e,r),resource:l(t,e,r),state:h(e,r),email:"aad"===e?n:null},f="aad"===e?"&msafed=0":"&aadredir=1";return i=s,u=encodeURIComponent(x),c=i.authorizationURL+"?response_type=token&client_id="+i.clientId+"&redirect_uri="+u,c=S("scope",i.scope,c),c=S("resource",i.resource,c),c=S("login_hint",i.email,c),(c=S("state",i.state,c))+f}},_=U(R,C,L("syncToken")),z=U(k,T,L("graphToken")),I=U(P,F,L("plannerToken"));function H(t,e){return Object(i.d)({authorizationRedirectURL:_(e,t.flowType,t.authHint,"todoAPI")})}var M=n(58);var D=Object(M.a)("executor/fetchMSAUser"),E=function(t,e,n){return t.fetch(e.msaUserDataURL,V(e.graphToken)).then(N).then(Z).then(W(e)).then(B)},V=function(t){return{headers:new Headers({Authorization:"Bearer "+t})}},N=function(t){if(!t.ok)throw D.authZ.warn("AuthFlowStepFailed","MSA server send a bad response",{code:t.status,text:t.statusText}),new Error("Bad MSA Response");return t.json().catch(function(t){throw D.authZ.warn("AuthFlowStepFailed","MSA server responded with a malformed JSON"),t})},Z=function(t){if(!t.id)throw D.authZ.warn("AuthFlowStepFailed","User object from MSA has no id"),new Error("User object from MSA has no id");if(!t.userPrincipalName)throw D.authZ.warn("AuthFlowStepFailed","User object from MSA has no email"),new Error("User object from MSA has no email");return D.authZ.info("AuthFlowStepCompleted","Fetch MSA user succeeded"),{id:t.id,cid:t.id,tid:t.tid,email:t.userPrincipalName,givenName:t.givenName,name:t.displayName}},W=function(e){return function(t){return e.user=t,e.authHint=t.email,e}},B=function(t){return D.login(),t};function J(t){if(t.graphToken&&!t.user)return[{type:"fetch/msa/user"}]}var Q=Object(M.a)("executor/fetchAADUser"),K=function(t,e,n){return t.fetch(e.aadUserDataURL,q(e.graphToken)).then(G).then($).then(X(e)).then(Y(e))},q=function(t){return{headers:new Headers({Authorization:"Bearer "+t})}},G=function(t){if(!t.ok)throw Q.authZ.warn("AuthFlowStepFailed","AAD server send a bad response",{code:t.status,text:t.statusText}),new Error("Bad AAD Response");return t.json().catch(function(t){throw Q.authZ.warn("AuthFlowStepFailed","AAD server responded with a malformed JSON"),t})},$=function(t){if(!t.objectId)throw Q.authZ.warn("AuthFlowStepFailed","User object from AAD has no id"),new Error("User object from AAD has no id");if(!t.userPrincipalName)throw Q.authZ.warn("AuthFlowStepFailed","User object from AAD has no email"),new Error("User object from AAD has no email");return Q.authZ.info("AuthFlowStepCompleted","Fetch AAD user succeeded"),{id:t.objectId,tid:t.tid,email:t.userPrincipalName,name:t.displayName,givenName:t.givenName,assignedPlans:t.assignedPlans,assignedLicenses:t.assignedLicenses}},X=function(e){return function(t){return e.user=t,e.authHint=t.email,e}},Y=function(e){return function(t){return Q.login(),e}};function tt(t){if(t.graphToken&&!t.user)return[{type:"fetch/aad/user"}]}var et=n(176),nt=n(21);function rt(t,e){return Object(nt.a)(et.b,et.a)({msaUserDataURL:e.oAuth2.msa.graph.url,aadUserDataURL:e.oAuth2.aad.graph.url})}function ot(t,e){return Object(i.b)({authenticationRedirectURL:z(e,t.flowType,t.authHint)})}n(284),n(286);var at=n(285),it=n(119);function ut(t,e){var n=e.expires_in,r=e.access_token,o=e.state;if(!r||!n)return Object(it.b)();if("msa"===t.flowType){var a=g(o);if(a){if("exoToken"===a.tokenType)return Object(it.b)({exoToken:r})}else if(t.graphToken&&t.syncToken)return Object(it.b)({exoToken:r})}return Object(it.b)()}function ct(t,e){return Object(it.a)({exoRedirectURL:"msa"===t.flowType?_(e,t.flowType,t.authHint,"exoAPI"):null})}var st=function(t){return"aad"!==t.flowType||t.isAADAvailable?[]:[Object(c.i)()]},ft=n(198);function dt(t,e){return Object(ft.a)({isAADAvailable:e.oAuth2.msa.canSwitchProviders})}var lt=function(t,e){return e.isOnline?[Object(c.d)(),Object(c.k)(),Object(c.j)()]:[]};var ht=n(129),pt=Object(M.a)("executor/fetchTenant"),vt=function(t,e,n){return t.fetch(e.tenantCheckURL,(r=e.graphToken,{headers:new Headers({Authorization:"Bearer "+r})})).then(bt(e)).then(mt(e));var r},bt=function(e){return function(t){return t.ok?t.json().catch(function(t){throw pt.authZ.warn("AuthFlowStepFailed","AD Graph API server responded with a malformed JSON"),t}):404==t.status&&Object(ht.b)(e.user.email)?(pt.authZ.info("AuthFlowStepCompleted","Tenant check succeeded"),{value:!0}):(pt.authZ.warn("AuthFlowStepFailed","Received a malformed response from AD Graph API"),{value:!1})}},mt=function(e){return function(t){return e.user.validTenant=t.value,e}},Ot=n(199);function yt(t,e){return Object(Ot.a)({tenantCheckURL:e.servicePrincipalCheck.url})}var gt=function(t){var e=t.featureFlags,n=t.user;if(e.check_beta_access&&!Object(ht.a)(n.email))return[Object(c.b)()]},wt=function(t){var e=t.featureFlags,n=t.user;return!e.check_beta_access||n.betaAccess||Object(ht.a)(n.email)?[]:[Object(c.e)()]},jt=Object(M.a)("executor/betaAccessCheck"),xt=function(t,e,n){return t.fetch("/beta",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.user.email})}).then(St(e)).then(At(e))},St=function(t){return function(t){return t.ok?(jt.authZ.info("AuthFlowStepCompleted","Beta check succeeded"),{value:!0}):(jt.authZ.warn("AuthFlowStepFailed","Beta access check failed"),{value:!1})}},At=function(e){return function(t){return e.user.betaAccess=t.value,e}};function Rt(t){if(t.user)return[{type:"fetch/aad/license"},{type:"check",target:"license"}]}
// CONCATENATED MODULE: ../todo-auth/src/features/AADLicenseCheck/commandFn/validateLicense.ts
var kt=function(t){return t.user.validLicense?[]:["license_disabled"===t.user.licenseError?Object(c.f)():Object(c.g)()]},Ct=function(t){return Pt(t,"todoPlans")},Tt=function(t){return Pt(t,"validSKUs")},Pt=function(e,t){return e[t].map(function(t){return e.productSKUs[t]})},Ft=function(t){return"Enabled"===t.capabilityStatus},Lt=function(t,e){return-1!==e.indexOf(t.servicePlanId)},Ut=function(t,e){return-1!==e.indexOf(t.skuId)},_t=function(e,t){return 0===t.filter(function(t){return-1!==e.disabledPlans.indexOf(t)}).length},zt=function(e,t){return 0<t.filter(function(t){return-1!==e.assignedPlans.indexOf(t)}).length},It=function(n){return function(t,e){return 0<t.filter(function(t){return n(t,e)}).length}},Ht=It(function(t,e){var n=Ct(e);return Ft(t)&&Lt(t,n)}),Mt=It(function(t,e){var n=Ct(e),r=Tt(e);return Ut(t,r)&&zt(t,n)}),Dt=It(function(t,e){var n=Ct(e),r=Tt(e);return Ut(t,r)&&_t(t,n)}),Et=Object(M.a)("executor/license"),Vt=function(t,e){var n=e.licenses,r=Ht(e.user.assignedPlans,n),o=Mt(e.user.assignedLicenses,n),a=Dt(e.user.assignedLicenses,n);return(r||o)&&a?(e.user.validLicense=!0,e.user.licenseError=null,Et.authZ.info("AuthFlowStepCompleted","Licence check succeeded")):(e.user.validLicense=!1,e.user.licenseError=a?"license_missing":"license_disabled",Et.authZ.warn("AuthFlowStepFailed","License check has failed for a user")),Promise.resolve(e)};
// CONCATENATED MODULE: ../todo-auth/src/features/AADLicenseCheck/executor/license.ts
var Nt=Object(M.a)("executor/fetchAADUser"),Zt=function(t,e,n){return t.fetch("https://graph.windows.net/myorganization/me/licenseDetails?api-version=1.6",Wt(e.graphToken)).then(Bt).then(Jt).then(Qt(e))},Wt=function(t){return{headers:new Headers({Authorization:"Bearer "+t,"Content-Type":"application/json"})}},Bt=function(t){if(!t.ok)throw Nt.authZ.warn("AuthFlowStepFailed","AAD server send a bad response",{code:t.status,text:t.statusText}),new Error("Bad AAD Response");return t.json().catch(function(t){throw Nt.authZ.warn("AuthFlowStepFailed","AAD server responded with a malformed JSON"),t})},Jt=function(t){return Nt.authZ.info("AuthFlowStepCompleted","Fetch AAD license succeeded"),t.value&&t.value.map(function(t){var e=t.skuId,n=t.servicePlans;return{disabledPlans:(n||[]).filter(function(t){return"Disabled"===t.provisioningStatus}).map(function(t){return t.servicePlanId}),assignedPlans:(n||[]).map(function(t){return t.servicePlanId}),skuId:e}})},Qt=function(e){return function(t){return t&&(e.user.assignedLicenses=t),e}},Kt=n(200);
// CONCATENATED MODULE: ../todo-auth/src/features/AADLicenseCheck/stateParser/parseLicenses.ts
function qt(t,e){return Object(Kt.a)({licenses:e.license})}
// CONCATENATED MODULE: ../todo-auth/src/features/AADLicenseCheck/index.ts
var Gt=function(t){return"aad_auth"!==t.latestServerError.code||t.isAADAvailable?[]:[Object(c.d)(),Object(c.k)(),Object(c.i)()]};function $t(t,e){return function(t,e){if(!t.latestServerError)return!1;var n=t.latestServerError,r=n.code,o=n.description;return r&&e.oAuth2[t.flowType].canSwitchProviders&&-1!==o.indexOf("The user has requested to authenticate with")}(t,e)?Object(i.a)({flowType:"msa"===t.flowType?"aad":"msa"}):t}var Xt="AADSTS50058",Yt=function(t){var e=t.latestServerError,n=e.code,r=e.description;return n===Xt||r&&-1!==r.indexOf(Xt)?[Object(c.d)(),Object(c.k)()]:[]};var te=function(t){if(t.featureFlags.planner_integration&&"aad"===t.flowType&&!t.plannerToken)return[(e=t,{type:"redirect",path:e.plannerRedirectURL})];var e},ee=n(103);function ne(t,e){var n=e.access_token,r=e.expires_in,o=e.state;if(!n||!r)return Object(ee.b)();if("aad"===t.flowType){var a=g(o);if(a){if("plannerToken"===a.tokenType)return Object(ee.b)({plannerToken:n})}else if(t.graphToken&&t.syncToken)return Object(ee.b)({plannerToken:n})}return Object(ee.b)()}function re(t,e){return Object(ee.a)({plannerRedirectURL:"aad"===t.flowType?I(e,t.flowType,t.authHint):null})}var oe=function(t){var e=t.flowType,n=t.syncToken,r=t.graphToken;if(r&&n){var o=Object(f.b)(n),a=Object(f.a)(r),i=Boolean(a&&o),u=Boolean(a||o);if("aad"===e&&!i||"msa"===e&&u)return[Object(c.d)(),Object(c.k)(),Object(c.j)()]}return[]},ae=function(t){if(t.isOnline)return[Object(c.c)()]},ie=n(160);function ue(t,e){return Object(ie.a)({isOnline:e})}var ce=n(178),se=n.n(ce);Object(M.a)("executor/checkConnetion"),se()("static-assets/");n.d(e,"H",function(){return r}),n.d(e,"v",function(){return o}),n.d(e,"p",function(){return a}),n.d(e,"u",function(){return l}),n.d(e,"n",function(){return v}),n.d(e,"b",function(){return m}),n.d(e,"F",function(){return O}),n.d(e,"D",function(){return y}),n.d(e,"w",function(){return w}),n.d(e,"B",function(){return j}),n.d(e,"r",function(){return H}),n.d(e,"m",function(){return J}),n.d(e,"a",function(){return tt}),n.d(e,"j",function(){return E}),n.d(e,"h",function(){return K}),n.d(e,"E",function(){return rt}),n.d(e,"q",function(){return ot}),n.d(e,"G",function(){return at.b}),n.d(e,"t",function(){return ut}),n.d(e,"s",function(){return ct}),n.d(e,"J",function(){return st}),n.d(e,"o",function(){return dt}),n.d(e,"f",function(){return lt}),n.d(e,"k",function(){return vt}),n.d(e,"C",function(){return yt}),n.d(e,"d",function(){return gt}),n.d(e,"K",function(){return wt}),n.d(e,"i",function(){return xt}),
/* unused concated harmony import CheckAADLicenseCommand */
/* unused concated harmony import FetchAADLicenseCommand */
/* concated harmony reexport checkAADLicense */n.d(e,"c",function(){return Rt}),
/* concated harmony reexport validateLicense */n.d(e,"L",function(){return kt}),
/* concated harmony reexport checkLicense */n.d(e,"e",function(){return Vt}),
/* unused concated harmony import FetchAADLicense */
/* concated harmony reexport fetchAADLicense */n.d(e,"g",function(){return Zt}),
/* concated harmony reexport parseLicenses */n.d(e,"x",function(){return qt}),
/* concated harmony reexport validateProviderSwitch */n.d(e,"N",function(){return Gt}),
/* concated harmony reexport switchProvider */n.d(e,"I",function(){return $t}),
/* concated harmony reexport validateSilentSignIn */n.d(e,"O",function(){return Yt}),
/* unused concated harmony import PlannerRedirectCommand */
/* concated harmony reexport getPlannerToken */n.d(e,"l",function(){return te}),
/* concated harmony reexport parsePlannerToken */n.d(e,"A",function(){return ne}),
/* concated harmony reexport parsePlannerRedirectURL */n.d(e,"z",function(){return re}),
/* concated harmony reexport validateStateIntegrity */n.d(e,"P",function(){return oe}),
/* concated harmony reexport validateOnline */n.d(e,"M",function(){return ae}),
/* unused concated harmony import OnlineState */
/* concated harmony reexport parseOnlineState */n.d(e,"y",function(){return ue})},340:function(t,e,n){"use strict";function r(t){return t.config}n.d(e,"a",function(){return r})},341:function(t,e,n){"use strict"},342:function(t,e){},343:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return a});var r=n(74);function o(t){return Object(r.d)(t)}function a(t,e){return t+e}},36:function(t,e,n){"use strict";function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{type:"clear",fields:t}}function o(){return{type:"store",key:"todo-auth-context"}}function a(){return{type:"error",url:"/error/501"}}function i(){return{type:"error",url:"/error/503"}}function u(){return{type:"error",url:"/error/403/tenant"}}function c(){return{type:"fetch/aad/tenant"}}function s(){return{type:"fetch/beta"}}function f(){return{type:"error",url:"/error/403/beta"}}function d(){return{type:"error",url:"/error/403/license_missing"}}function l(){return{type:"error",url:"/error/403/license_disabled"}}function h(){return{type:"fetch/connection"}}n.d(e,"d",function(){return r}),n.d(e,"k",function(){return o}),n.d(e,"i",function(){return a}),n.d(e,"j",function(){return i}),n.d(e,"h",function(){return u}),n.d(e,"a",function(){return c}),n.d(e,"b",function(){return s}),n.d(e,"e",function(){return f}),n.d(e,"g",function(){return d}),n.d(e,"f",function(){return l}),n.d(e,"c",function(){return h})},374:function(t,e,n){"use strict";var o=n(36),r=function(t){return[Object(o.k)()]};var a=function(t){var e,n=(e=t,Boolean(e.flowType&&(e.syncToken||e.graphToken))),r=Boolean(t.redirectPath);return n?[Object(o.k)()]:r?[Object(o.d)("flowType","authHint"),Object(o.k)()]:[]};var i=function(t,e,n){var r=Object.assign({},e);return delete r.licenses,t.storage.setItem(n.key,JSON.stringify(r)),Promise.resolve(e)},u=n(113),c=function(t,e,n){if(!n.fields.length)return Promise.resolve(Object(u.a)());var r=Object(u.a)(e);return n.fields.forEach(function(t){return r[t]=Object(u.a)()[t]}),Promise.resolve(r)},s=n(241);n.d(e,"d",function(){return r}),n.d(e,"e",function(){return a}),n.d(e,"c",function(){return i}),n.d(e,"a",function(){return c}),n.d(e,"b",function(){return s.a})},375:function(t,e,n){"use strict";var r=function(t,e,n){return"restoreURL"===n.type&&(t.history.replaceState({},"",e.redirectPath),e.redirectPath=null),Promise.resolve(e)},o=function(t){return[{type:"restoreURL"}]},a=n(110),i=n(74);function u(t,e){var n,r,o=(void 0===(n=e)&&(n=""),Object(i.c)(n,"app","switchAccount","__rev"));return void 0===(r=o)&&(r=""),o=r.replace("/auth/callback",""),Object(a.a)({redirectPath:o})}n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return u})},376:function(t,e,n){"use strict";var r=n(201);var o=function(t){if(!Object(r.b)()||!1===t.isOnline){var e="/sharing"===window.location.pathname?t.invitationAppFilePath:t.mainAppFilePath;return[(n=e,{type:"route",value:n})]}var n},a=function(t,e,n){var r,o;return"route"===n.type&&(r=n.value,(o=document.createElement("script")).src=r,document.head.appendChild(o)),Promise.resolve(e)};var i=n(162);function u(t,e){return Object(i.a)({mainAppFilePath:e.mainAppFilePath,invitationAppFilePath:e.invitationAppFilePath})}n.d(e,"b",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"c",function(){return u})},377:function(t,e,n){"use strict";var r=n(58);Object(r.a)("executor/notify");var i=function(t,e,n){try{t.evaluationContext.opener?t.evaluationContext.opener.postMessage(n,e):t.evaluationContext.top.postMessage(n,e)}catch(t){}},o=function(e,t,n){var r=["https://dev.import.todo.microsoft.com","https://import.todo.microsoft.com","https://import.to-do.microsoft.com"],o={type:"auth:updated",payload:t};try{var a=e.evaluationContext.opener?e.evaluationContext.opener.location.origin:e.evaluationContext.top.location.origin;void 0===a&&(a=e.evaluationContext.top.location.protocol+"//"+e.evaluationContext.top.location.host),i(e,a,o)}catch(t){r.forEach(function(t){i(e,t,o)})}return Promise.resolve(t)},a=n(201);function u(t){if(Object(a.b)())return[{type:"notify"}]}n.d(e,"b",function(){return u}),n.d(e,"a",function(){return o})},378:function(t,e,n){"use strict";var r=n(34),o=n(33),a=function(){return[Object(o.ParseCommand)(o.readState,"storage"),Object(o.OverrideCommand)(o.parseFeatureFlags,"featureFlags"),Object(o.OverrideCommand)(r.y,"onLine"),
// read urls and licenses from config
Object(o.ParseCommand)(r.F,"config"),Object(o.ParseCommand)(r.C,"config"),Object(o.ParseCommand)(r.E,"config"),Object(o.OverrideCommand)(r.x,"config"),Object(o.OverrideCommand)(r.o,"config"),Object(o.OverrideCommand)(o.parseServerError,"params"),Object(o.OverrideCommand)(r.u,"params"),Object(o.ParseCommand)(r.D,"params"),Object(o.ParseCommand)(r.A,"params"),Object(o.ParseCommand)(r.t,"params"),Object(o.ParseCommand)(r.w,"params"),Object(o.OverrideCommand)(r.B,"params"),Object(o.OverrideCommand)(r.p,"params"),Object(o.OverrideCommand)(r.I,"config"),Object(o.OverrideCommand)(r.r,"config"),Object(o.OverrideCommand)(r.q,"config"),Object(o.OverrideCommand)(r.s,"config"),Object(o.OverrideCommand)(r.z,"config"),Object(o.OverrideCommand)(o.parseInteractiveMode,"evaluationContext"),Object(o.ParseCommand)(o.parseRedirectPath,"path"),Object(o.OverrideCommand)(r.v,"params"),Object(o.OverrideCommand)(o.parseRoutingState,"config")]};n.d(e,"a",function(){return a})},379:function(t,e,n){"use strict";var r=n(58),o=Object(r.a)("executor/redirect"),a=function(t,e,n){return o.authN.info("AuthFlowRedirected","Auth flow redirected to "+n.path),t.location.href=n.path,Promise.resolve(null)};n.d(e,"a",function(){return a})},380:function(t,e,n){"use strict";var r=n(58),o=Object(r.a)("executor/error"),a=function(t,e,n){return o.authN.error("AuthFlowFailed","Auth flow failed. Redirecting user to error page",{url:n.url}),window.location.href=n.url,Promise.resolve(null)};n.d(e,"a",function(){return a})},381:function(t,e,n){"use strict";var o=n(163);function r(t,e){var n=e.error,r=e.error_description;return Object(o.a)({latestServerError:{code:n,description:r}})}n.d(e,"a",function(){return r})},382:function(t,e,n){"use strict";function r(t,e){return{type:"parse",mode:"read",fn:t,target:e}}function o(t,e){return{type:"parse",mode:"override",fn:t,target:e}}var a=function(t,e,n){var r,o,a,i,u=t[n.target],c=n.fn(e,u),s="read"===n.mode?(a=e,i=c,Object.keys(i).forEach(function(t){a.hasOwnProperty(t)&&(a[t]=a[t]||i[t])}),a):(r=e,o=c,Object.keys(o).forEach(function(t){r.hasOwnProperty(t)&&(r[t]=o[t])}),r);return Promise.resolve(s)};n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o}),n.d(e,"c",function(){return a})},383:function(t,e,n){"use strict";var r=n(103),o=n(53),a=n(21),i=Object(a.a)(r.a,o.d,o.b);function u(t,e){var n,r=(n=e).top===n.self?"":"&prompt=none";return i({plannerRedirectURL:t.plannerRedirectURL&&t.plannerRedirectURL+r,authenticationRedirectURL:t.authenticationRedirectURL+r,authorizationRedirectURL:t.authorizationRedirectURL+r})}n.d(e,"a",function(){return u})},476:function(t,e){t.exports='<svg width="188" height="147" xmlns="http://www.w3.org/2000/svg"><style> #wheel-1 path, #wheel-3 path { animation: rotate_right 2.4s infinite; transform-origin:50% 50%; transform-box: fill-box; } #wheel-2 path, #wheel-4 path { animation: rotate_left 2.4s infinite; transform-origin:50% 50%; transform-box: fill-box; } @keyframes rotate_right { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } @keyframes rotate_left { from { transform: rotate(0deg); } to { transform: rotate(-360deg); } } </style><g transform="translate(-510 -240)" fill="#445DF7" stroke-width="1" fill-rule="evenodd"><g transform="translate(498 234)"><g id="wheel-1" transform="rotate(-35 114.328 35.34)"><path d="M60.884 35.604v-9.138h-7.228a23.137 23.137 0 0 0-3.453-8.33l5.11-5.11-6.464-6.464-5.114 5.11a23.134 23.134 0 0 0-8.329-3.452V.984h-9.134v7.228a23.126 23.126 0 0 0-8.329 3.453l-5.11-5.11-6.465 6.472 5.11 5.11a23.126 23.126 0 0 0-3.452 8.329H.802v9.138h7.224a23.122 23.122 0 0 0 3.453 8.329l-5.11 5.11 6.464 6.464 5.11-5.11a23.13 23.13 0 0 0 8.329 3.453v7.228h9.142V53.85a23.126 23.126 0 0 0 8.329-3.453l5.11 5.11 6.464-6.464-5.114-5.09a23.149 23.149 0 0 0 3.453-8.33l7.228-.019zm-30.04 6.553c-6.144 0-11.125-4.981-11.125-11.126 0-6.144 4.981-11.126 11.126-11.126 6.144 0 11.126 4.982 11.126 11.126a11.126 11.126 0 0 1-11.13 11.126h.004z" fill-opacity=".05"></path><path d="M36.097 61.757H25.589v-7.354a23.686 23.686 0 0 1-7.558-3.131l-5.202 5.202-7.427-7.427 5.202-5.202a23.686 23.686 0 0 1-3.13-7.558H.122V25.783h7.354a23.686 23.686 0 0 1 3.13-7.554l-5.201-5.202 7.427-7.44 5.198 5.215a23.686 23.686 0 0 1 7.554-3.131V.313H36.09v7.354a23.686 23.686 0 0 1 7.554 3.13l5.21-5.21 7.427 7.428-5.202 5.202a23.698 23.698 0 0 1 3.13 7.554h7.355V36.28H54.21a23.698 23.698 0 0 1-3.13 7.558l5.201 5.202-7.427 7.428-5.202-5.203a23.69 23.69 0 0 1-7.554 3.13v7.363zm-9.142-1.366h7.776V53.29l.549-.111a22.355 22.355 0 0 0 8.072-3.35l.464-.31 5.026 5.022 5.497-5.498-5.022-5.022.311-.464a22.363 22.363 0 0 0 3.35-8.083l.11-.549h7.102v-7.776h-7.094l-.111-.549a22.359 22.359 0 0 0-3.35-8.083l-.31-.465 5.026-5.025-5.498-5.498-5.026 5.022-.464-.31a22.351 22.351 0 0 0-8.068-3.35l-.548-.111V1.679h-7.792v7.105l-.549.11a22.359 22.359 0 0 0-8.083 3.35l-.464.31-5.022-5.021-5.498 5.498 5.022 5.021-.31.465A22.351 22.351 0 0 0 8.7 26.6l-.111.549H1.485v7.776h7.1l.112.549a22.347 22.347 0 0 0 3.353 8.094l.311.465-5.026 5.025 5.498 5.498 5.026-5.022.464.31a22.351 22.351 0 0 0 8.083 3.35l.549.111v7.086zm3.886-17.555A11.805 11.805 0 1 1 42.646 31.03c-.005 6.518-5.287 11.802-11.805 11.809v-.004zm0-22.252a10.439 10.439 0 1 0 10.439 10.44c-.013-5.759-4.68-10.422-10.439-10.428v-.012z" fill-rule="nonzero"></path><path d="M30.841 37.162a6.138 6.138 0 1 1 0-12.277 6.138 6.138 0 0 1 0 12.277zm0-10.892a4.765 4.765 0 1 0 0 9.53 4.765 4.765 0 0 0 0-9.53z" fill-rule="nonzero"></path></g><g id="wheel-2" transform="rotate(13 -336.96 312.976)"><path d="M60.884 35.604v-9.138h-7.228a23.137 23.137 0 0 0-3.453-8.33l5.11-5.11-6.464-6.464-5.114 5.11a23.134 23.134 0 0 0-8.329-3.452V.984h-9.134v7.228a23.126 23.126 0 0 0-8.329 3.453l-5.11-5.11-6.465 6.472 5.11 5.11a23.126 23.126 0 0 0-3.452 8.329H.802v9.138h7.224a23.122 23.122 0 0 0 3.453 8.329l-5.11 5.11 6.464 6.464 5.11-5.11a23.13 23.13 0 0 0 8.329 3.453v7.228h9.142V53.85a23.126 23.126 0 0 0 8.329-3.453l5.11 5.11 6.464-6.464-5.114-5.09a23.149 23.149 0 0 0 3.453-8.33l7.228-.019zm-30.04 6.553c-6.144 0-11.125-4.981-11.125-11.126 0-6.144 4.981-11.126 11.126-11.126 6.144 0 11.126 4.982 11.126 11.126a11.126 11.126 0 0 1-11.13 11.126h.004z" fill-opacity=".1"></path><path d="M36.097 61.757H25.589v-7.354a23.686 23.686 0 0 1-7.558-3.131l-5.202 5.202-7.427-7.427 5.202-5.202a23.686 23.686 0 0 1-3.13-7.558H.122V25.783h7.354a23.686 23.686 0 0 1 3.13-7.554l-5.201-5.202 7.427-7.44 5.198 5.215a23.686 23.686 0 0 1 7.554-3.131V.313H36.09v7.354a23.686 23.686 0 0 1 7.554 3.13l5.21-5.21 7.427 7.428-5.202 5.202a23.698 23.698 0 0 1 3.13 7.554h7.355V36.28H54.21a23.698 23.698 0 0 1-3.13 7.558l5.201 5.202-7.427 7.428-5.202-5.203a23.69 23.69 0 0 1-7.554 3.13v7.363zm-9.142-1.366h7.776V53.29l.549-.111a22.355 22.355 0 0 0 8.072-3.35l.464-.31 5.026 5.022 5.497-5.498-5.022-5.022.311-.464a22.363 22.363 0 0 0 3.35-8.083l.11-.549h7.102v-7.776h-7.094l-.111-.549a22.359 22.359 0 0 0-3.35-8.083l-.31-.465 5.026-5.025-5.498-5.498-5.026 5.022-.464-.31a22.351 22.351 0 0 0-8.068-3.35l-.548-.111V1.679h-7.792v7.105l-.549.11a22.359 22.359 0 0 0-8.083 3.35l-.464.31-5.022-5.021-5.498 5.498 5.022 5.021-.31.465A22.351 22.351 0 0 0 8.7 26.6l-.111.549H1.485v7.776h7.1l.112.549a22.347 22.347 0 0 0 3.353 8.094l.311.465-5.026 5.025 5.498 5.498 5.026-5.022.464.31a22.351 22.351 0 0 0 8.083 3.35l.549.111v7.086zm3.886-17.555A11.805 11.805 0 1 1 42.646 31.03c-.005 6.518-5.287 11.802-11.805 11.809v-.004zm0-22.252a10.439 10.439 0 1 0 10.439 10.44c-.013-5.759-4.68-10.422-10.439-10.428v-.012z" fill-rule="nonzero"></path><path d="M30.841 37.162a6.138 6.138 0 1 1 0-12.277 6.138 6.138 0 0 1 0 12.277zm0-10.892a4.765 4.765 0 1 0 0 9.53 4.765 4.765 0 0 0 0-9.53z" fill-rule="nonzero"></path></g><g id="wheel-3" transform="rotate(9 -225.949 664.898)"><path d="M60.884 35.604v-9.138h-7.228a23.137 23.137 0 0 0-3.453-8.33l5.11-5.11-6.464-6.464-5.114 5.11a23.134 23.134 0 0 0-8.329-3.452V.984h-9.134v7.228a23.126 23.126 0 0 0-8.329 3.453l-5.11-5.11-6.465 6.472 5.11 5.11a23.126 23.126 0 0 0-3.452 8.329H.802v9.138h7.224a23.122 23.122 0 0 0 3.453 8.329l-5.11 5.11 6.464 6.464 5.11-5.11a23.13 23.13 0 0 0 8.329 3.453v7.228h9.142V53.85a23.126 23.126 0 0 0 8.329-3.453l5.11 5.11 6.464-6.464-5.114-5.09a23.149 23.149 0 0 0 3.453-8.33l7.228-.019zm-30.04 6.553c-6.144 0-11.125-4.981-11.125-11.126 0-6.144 4.981-11.126 11.126-11.126 6.144 0 11.126 4.982 11.126 11.126a11.126 11.126 0 0 1-11.13 11.126h.004z" fill-opacity=".04"></path><path d="M36.097 61.757H25.589v-7.354a23.686 23.686 0 0 1-7.558-3.131l-5.202 5.202-7.427-7.427 5.202-5.202a23.686 23.686 0 0 1-3.13-7.558H.122V25.783h7.354a23.686 23.686 0 0 1 3.13-7.554l-5.201-5.202 7.427-7.44 5.198 5.215a23.686 23.686 0 0 1 7.554-3.131V.313H36.09v7.354a23.686 23.686 0 0 1 7.554 3.13l5.21-5.21 7.427 7.428-5.202 5.202a23.698 23.698 0 0 1 3.13 7.554h7.355V36.28H54.21a23.698 23.698 0 0 1-3.13 7.558l5.201 5.202-7.427 7.428-5.202-5.203a23.69 23.69 0 0 1-7.554 3.13v7.363zm-9.142-1.366h7.776V53.29l.549-.111a22.355 22.355 0 0 0 8.072-3.35l.464-.31 5.026 5.022 5.497-5.498-5.022-5.022.311-.464a22.363 22.363 0 0 0 3.35-8.083l.11-.549h7.102v-7.776h-7.094l-.111-.549a22.359 22.359 0 0 0-3.35-8.083l-.31-.465 5.026-5.025-5.498-5.498-5.026 5.022-.464-.31a22.351 22.351 0 0 0-8.068-3.35l-.548-.111V1.679h-7.792v7.105l-.549.11a22.359 22.359 0 0 0-8.083 3.35l-.464.31-5.022-5.021-5.498 5.498 5.022 5.021-.31.465A22.351 22.351 0 0 0 8.7 26.6l-.111.549H1.485v7.776h7.1l.112.549a22.347 22.347 0 0 0 3.353 8.094l.311.465-5.026 5.025 5.498 5.498 5.026-5.022.464.31a22.351 22.351 0 0 0 8.083 3.35l.549.111v7.086zm3.886-17.555A11.805 11.805 0 1 1 42.646 31.03c-.005 6.518-5.287 11.802-11.805 11.809v-.004zm0-22.252a10.439 10.439 0 1 0 10.439 10.44c-.013-5.759-4.68-10.422-10.439-10.428v-.012z" fill-rule="nonzero"></path><path d="M30.841 37.162a6.138 6.138 0 1 1 0-12.277 6.138 6.138 0 0 1 0 12.277zm0-10.892a4.765 4.765 0 1 0 0 9.53 4.765 4.765 0 0 0 0-9.53z" fill-rule="nonzero"></path></g><g id="wheel-4" transform="rotate(14 70.995 592.388)"><path d="M15.963 52.379l2.302-2.302a23.149 23.149 0 0 0 8.329 3.453v7.224h9.142v-7.236a23.13 23.13 0 0 0 8.329-3.453l5.11 5.11 6.457-6.452-5.11-5.11a23.13 23.13 0 0 0 3.452-8.33h7.224v-9.145H53.97a23.122 23.122 0 0 0-3.452-8.33l5.114-5.11-6.465-6.464-5.11 5.11a23.118 23.118 0 0 0-8.329-3.452V.668h-9.142v7.224a23.126 23.126 0 0 0-8.329 3.452l-5.11-5.11L6.683 12.7l5.11 5.11a23.13 23.13 0 0 0-3.453 8.329H1.12v9.157h7.224a23.13 23.13 0 0 0 3.453 8.329l-5.11 5.099 6.464 6.464 2.8-2.8.012-.008zm15.196-10.562c-6.145 0-11.126-4.981-11.126-11.126 0-6.144 4.981-11.125 11.126-11.125 6.144 0 11.126 4.98 11.126 11.125s-4.982 11.126-11.126 11.126z" fill-opacity=".14"></path><path d="M36.411 61.429H25.907v-7.355a23.71 23.71 0 0 1-7.554-3.13l-1.918 1.918-3.626 3.07-7.086-7.21 5.199-5.198a23.678 23.678 0 0 1-3.13-7.554H.436V25.455H7.79a23.675 23.675 0 0 1 3.13-7.554L5.72 12.695l7.427-7.428 5.202 5.203a23.682 23.682 0 0 1 7.554-3.13V0h10.508v7.354a23.678 23.678 0 0 1 7.558 3.116l5.202-5.203 7.427 7.432-5.202 5.202a23.686 23.686 0 0 1 3.13 7.554h7.355v10.504h-7.358a23.705 23.705 0 0 1-3.13 7.554l5.201 5.21-7.427 7.427-5.198-5.21a23.682 23.682 0 0 1-7.554 3.13l-.004 7.359zm-9.142-1.366h7.776v-7.12l.549-.112a22.355 22.355 0 0 0 8.083-3.341l.464-.31 5.026 5.025 5.498-5.482-5.026-5.026.31-.464a22.351 22.351 0 0 0 3.35-8.084l.111-.548h7.101v-7.784h-7.1l-.112-.549a22.347 22.347 0 0 0-3.35-8.083l-.31-.465 5.026-5.021L49.167 7.2l-5.026 5.026-.464-.311a22.351 22.351 0 0 0-8.083-3.35l-.549-.11V1.35H27.27v7.09l-.549.111a22.355 22.355 0 0 0-8.072 3.342l-.464.31-5.022-5.025-5.497 5.498L12.69 17.7l-.31.464a22.363 22.363 0 0 0-3.35 8.084l-.107.548H1.799v7.777h7.105l.107.548a22.363 22.363 0 0 0 3.35 8.084l.31.464-5.026 5.053 5.245 5.37 2.616-2.213 2.667-2.685.475.295a22.37 22.37 0 0 0 8.057 3.36l.548.112.016 7.101zm3.89-17.555c-6.519.002-11.805-5.28-11.809-11.799-.003-6.518 5.278-11.806 11.796-11.81 6.519-.006 11.807 5.274 11.814 11.792 0 6.52-5.281 11.808-11.801 11.817zm0-22.252a10.439 10.439 0 1 0 10.439 10.435c-.015-5.756-4.682-10.417-10.439-10.423v-.012z" fill-rule="nonzero"></path><path d="M31.159 36.83a6.138 6.138 0 1 1 0-12.277 6.138 6.138 0 0 1 0 12.277zm0-10.892a4.765 4.765 0 1 0 4.753 4.753 4.769 4.769 0 0 0-4.753-4.75v-.003z" fill-rule="nonzero"></path></g></g></g></svg>'},53:function(t,e,n){"use strict";n.d(e,"e",function(){return o}),n.d(e,"c",function(){return a}),n.d(e,"f",function(){return c}),n.d(e,"g",function(){return s}),n.d(e,"d",function(){return f}),n.d(e,"b",function(){return d}),n.d(e,"a",function(){return l});var r=n(21),o=Object(r.b)({syncToken:null}),a=Object(r.b)({graphToken:null}),i=Object(r.b)({expiresIn:null}),u=Object(r.b)({expirationDate:null}),c=Object(r.a)(i,u),s=Object(r.a)(o,a,c),f=Object(r.b)({authorizationRedirectURL:null}),d=Object(r.b)({authenticationRedirectURL:null}),l=Object(r.b)({flowType:void 0})},58:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(141),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(r,o){return{error:function(t,e,n){r({severity:"Error",signature:t,message:e,details:a({},n,{namespace:o})})},warn:function(t,e,n){r({severity:"Warning",signature:t,message:e,details:n})},info:function(t,e,n){r({severity:"Info",signature:t,message:e,details:a({},n,{namespace:o})})}}},i=function(t){var e=Object(r.a)();return{authN:o(e.authentication,t),authZ:o(e.authorization,t),login:e.login}}},74:function(t,e,n){"use strict";n.d(e,"d",function(){return r}),n.d(e,"c",function(){return o}),n.d(e,"a",function(){return i}),n.d(e,"b",function(){return u});var a=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||0<e--)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i};function r(t){return void 0===t&&(t=""),t.slice(1).split("&").reduce(function(t,e){if(!e)return t;var n=a(e.split("="),2),r=n[0],o=n[1];return t[r]=void 0===o?void 0:decodeURIComponent(o).replace(/\+/g," "),t},{})}function o(t){void 0===t&&(t="");for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(t,e){return t.replace(new RegExp("([\\?&])\\b"+e+"\\b=?[^&]*(&)?","gi"),function(t,e,n){return n?e:""})},t)}function i(t,e,n){void 0===t&&(t=""),void 0===n&&(n="");var r=-1!==t.indexOf("?")?"&":"?";return""+t+r+(e+(n?"="+encodeURIComponent(n):""))}function u(t,e){void 0===t&&(t=""),void 0===e&&(e="");var n=-1!==t.indexOf("?")?"&":"?";return""+t+n+e}},767:function(t,e,n){"use strict";n.r(e);var r=n(476),o=n.n(r),a=(new DOMParser).parseFromString(o.a,"image/svg+xml").documentElement;a.id="loading_icon",a.style.position="absolute",a.style.top="50%",a.style.left="50%",a.style.transform="translate(-50%, -50%)";var i,u=a,c=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||0<e--)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},s=function(){function t(t,e,n){var o=this;this.step=function(t,e){var n,r=e&&e.shift();try{n=r?o.interpreter(t,r):Promise.resolve(t)}catch(t){n=Promise.reject(t)}return[n,e]},this.run=function(n){return function(t){if(t){var e="function"==typeof n?n(t):n;return o.loop(t,e)}}},this.context=t,this.interpreter=e,this.controlFlow=Promise.resolve(this.context),this.logger=n("todo-auth/flow")}return t.prototype.loop=function(t,e){var n=this,r=c(this.step(t,e),2),o=r[0],a=r[1];return a&&a.length?o.then(function(t){return n.loop(t,a)}):o},t.prototype.delayedPromise=function(e,n){var r=this;return new Promise(function(t){setTimeout(function(){return t(e(r.context))},n)})},t.prototype.next=function(t){return this.controlFlow=this.controlFlow.then(this.run(t)),this},t.prototype.nextWithRetry=function(e,n,r){var o=this;void 0===n&&(n=1),void 0===r&&(r=0);var a=function(t){return Promise.resolve(t).then(o.run(e)).catch(function(t){if(0<=--n)return o.logger.authN.warn("AuthFlowStepFailed","Retrying flow: "+n),o.delayedPromise(a,r);throw t})};return this.controlFlow=this.controlFlow.then(a),this},t.prototype.toPromise=function(){return this.controlFlow},t.prototype.catch=function(n){var r=this;return this.controlFlow=this.controlFlow.catch(function(t){r.logger.authN.warn("AuthFlowStepFailed","Authentication flow error",t);var e=n(t,r.context);return r.run(e)(r.context)}),this},t}(),f=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e}(s),l=n(34),h=n(33),p=n(287),v=n(289),b=n(308),m={params:Object.assign({},Object(b.parseLocationQuery)(window.location.search),Object(b.parseLocationQuery)(window.location.hash)),path:Object(b.parseLocationPath)(window.location.pathname,window.location.search),config:Object(p.read)(window.__initialState),featureFlags:Object(v.b)(window.__initialState),fetch:fetch.bind(window),location:window.location,history:window.history,evaluationContext:{top:window.top,self:window.self,opener:window.opener},storage:window.localStorage,onLine:window.navigator.onLine};var O,y=n(58),g=n(286),w=n(284),j={redirect:h.redirect,route:h.load,"fetch/msa/user":l.j,"fetch/aad/user":l.h,"fetch/aad/tenant":l.k,"fetch/aad/license":l.g,"fetch/beta":l.i,"fetch/mailbox":l.G,store:h.store,clear:h.clear,error:h.error,notify:h.notify,check:l.e,restoreURL:h.restoreURL,parse:h.parse},x=(O=j,function(n){return function(t,e){return O[e.type]?O[e.type](n,t,e):Promise.resolve(t)}}),S=n(113),A=Object(y.a)("entry");window.location.hash="";document.body.appendChild(u),new d(Object(S.a)(),x(m),y.a).next(h.readInitialState).next(l.M).next(function(t){return!0===t.isOnline?"msa"===t.flowType?(n=t,A.authN.info("AuthFlowStarted","MSA Auth started"),new d(n,x(m),y.a).next(h.storeContextIfValid).next(l.N).next(l.O).next(l.H).next(l.n).next(l.P).nextWithRetry(l.m,3,300).next(h.storeContextIfValid).nextWithRetry(l.d,3,300).next(l.K).next(g.a).nextWithRetry(w.a,3,300).catch(l.f).next(h.restoreOriginalURL).next(h.storeContext).next(h.loadClient).next(h.notifyWhenRefreshed)):(e=t,A.authN.info("AuthFlowStarted","AAD Auth started"),new d(e,x(m),y.a).next(l.J).next(h.storeContextIfValid).next(l.O).next(l.H).next(l.b).next(l.P).nextWithRetry(l.a,3,300).next(h.storeContextIfValid).nextWithRetry(l.d,3,300).next(l.K).next(l.c).next(l.L).next(l.l).catch(l.f).next(h.restoreOriginalURL).next(h.storeContext).next(h.loadClient).next(h.notifyWhenRefreshed)):new d(t,x(m),y.a).next(h.loadClient),[];var e,n})}});